(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{625:function(s,n,a){"use strict";a.r(n);var e=a(3),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"react-router-dom6-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#react-router-dom6-使用"}},[s._v("#")]),s._v(" react-router-dom6 使用")]),s._v(" "),a("p",[s._v("菜单的json如下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('[\n  {\n    id: \'1\',     // 唯一的id\n    name: "模块一",  // 菜单名称 \n    path: "/model1/dashboard",    // 菜单路径\n    children: [                   // 子菜单\n      {\n        id: \'2\',\n        name: "首页",\n        path: "/model1/dashboard",\n        icon: "",\n      },\n      {\n        id: \'3\',\n        name: "二级菜单",\n        path: "/model1",\n        icon: "",\n        children: [\n          {\n            id: \'6\',\n            name: "2-1-home",\n            path: "/model1/home",\n            icon: "",\n          }\n        ]\n      },\n    ],\n  },\n  {\n    id: \'4\',\n    name: "模块二",\n    path: "/model2",\n  },\n  {\n    id: \'5\',\n    name: "模块三",\n    path: "/model3",\n  },\n]\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br")])]),a("p",[s._v("根据这个 json 动态生成路由和菜单信息")]),s._v(" "),a("h2",{attrs:{id:"安装方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装方法"}},[s._v("#")]),s._v(" 安装方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ yarn add react-router-dom\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"使用方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用方法"}},[s._v("#")]),s._v(" 使用方法")]),s._v(" "),a("p",[s._v("这个deme采用的 "),a("code",[s._v("vite")]),s._v("搭建的本地环境。并添加 路由库。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ yarn create vite react-router6-dom-study --template react\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("哦，对了本来不想使用组件库的，只想简单的使用一下，后面想着能不能做一个动态生成路由和菜单的功能，简单实现一下呢。于是就添加了 "),a("code",[s._v("antd")]),s._v("这个组件库")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("$ yarn add antd\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("启用全局模式 HashRouter和BrowserRouter 两种模式，")]),s._v(" "),a("p",[s._v("区分")]),s._v(" "),a("ul",[a("li",[s._v("HashRouter:URL中采用的是hash(#)部分去创建路由，类似"),a("a",{attrs:{href:"https://link.juejin.cn/?target=http%3A%2F%2Fwww.example.com%2F%23%2F",target:"_blank",rel:"noopener noreferrer"}},[s._v("www.example.com/#/"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("BrowserRouter：URL采用真实的URL资源 后续有文章会详细讲HashRouter的原理和实现，这里我们采用BrowserRouter来创建路由")])]),s._v(" "),a("p",[s._v("main.jsx如下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('import React from "react";\nimport ReactDOM from "react-dom";\nimport {BrowserRouter} from "react-router-dom";\nimport zhCN from "antd/lib/locale/zh_CN";\nimport "antd/dist/antd.css";\n\nimport "./index.css";\nimport App from "./App";\n\nReactDOM.render(\n  <BrowserRouter>\n    <App/>\n  </BrowserRouter>,\n  document.getElementById("root")\n);\n\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br")])]),a("p",[s._v("这样运行 "),a("code",[s._v("yarn dev")]),s._v("的时候在访问/的时候就可以看见这个组件了。")]),s._v(" "),a("h2",{attrs:{id:"路由组件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由组件"}},[s._v("#")]),s._v(" 路由组件")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("组件名")]),s._v(" "),a("th",[s._v("作用")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("<Routers>")])]),s._v(" "),a("td",[s._v("一组路由")]),s._v(" "),a("td",[s._v("代替原有"),a("code",[s._v("<Switch>")]),s._v("，所有子路由都用基础的Router children来表示")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("<Router>")])]),s._v(" "),a("td",[s._v("基础路由")]),s._v(" "),a("td",[s._v("Router是可以嵌套的，解决原有V5中严格模式，后面与V5区别会详细介绍")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("<Link>")])]),s._v(" "),a("td",[s._v("导航组件")]),s._v(" "),a("td",[s._v("在实际页面中跳转使用")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("<Outlet/>")])]),s._v(" "),a("td",[s._v("自适应渲染组件")]),s._v(" "),a("td",[s._v("根据实际路由url自动选择组件, 一般用来实现嵌套路由。")])])])]),s._v(" "),a("h2",{attrs:{id:"hooks"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hooks"}},[s._v("#")]),s._v(" hooks")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("hooks名")]),s._v(" "),a("th",[s._v("作用")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("useParams")])]),s._v(" "),a("td",[s._v("返回当前参数")]),s._v(" "),a("td",[s._v("根据路径读取参数")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("useNavigate")])]),s._v(" "),a("td",[s._v("返回当前路由")]),s._v(" "),a("td",[s._v("代替原有V5中的 useHistor, 一般用来跳转页面和")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("useOutlet")])]),s._v(" "),a("td",[s._v("返回根据路由生成的element")]),s._v(" "),a("td",[s._v("还没使用，有机会试试")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("useLocation")])]),s._v(" "),a("td",[s._v("返回当前的location 对象")]),s._v(" "),a("td",[s._v("可以获取 useNavigate('', {state: {id}})  里面的id参数")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("useRoutes")])]),s._v(" "),a("td",[s._v("同Routers组件一样，只不过是在js中使用")]),s._v(" "),a("td",[s._v("可用作配置路由")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("useSearchParams")])]),s._v(" "),a("td",[s._v("用来匹配URL中?后面的搜索参数")]),s._v(" "),a("td",[s._v("用来获取  ?x=1&y=100 这样的参数")])])])]),s._v(" "),a("h3",{attrs:{id:"routes-route-link-使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#routes-route-link-使用"}},[s._v("#")]),s._v(" Routes Route Link 使用")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('import \'./App.css\';\nimport { Routes, Route, Link } from "react-router-dom"\nfunction App() {\n  return (\n    <div className="App">\n      <header className="App-header">\n        <Routes>\n          <Route path="/" element={<Home />}></Route>\n          <Route path="/about" element={<About />}></Route>\n        </Routes>\n      </header>\n    </div>\n  );\n}\nfunction Home() {\n  return <div>\n    <main>\n      <h2>Welcome to the homepage</h2>\n    </main>\n    <nav>\n      <Link to="/about">about</Link>\n    </nav>\n  </div>\n}\nfunction About() {\n  return <div>\n    <main>\n      <h2>Welcome to the about page</h2>\n    </main>\n    <nav>\n      <ol>\n        <Link to="/">home</Link>\n        <Link to="/about">about</Link>\n      </ol>\n\n    </nav>\n  </div>\n}\nexport default App;\n\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br")])]),a("h3",{attrs:{id:"嵌套路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#嵌套路由"}},[s._v("#")]),s._v(" 嵌套路由")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function App() {\n  return (\n    <Routes>\n      <Route path="user" element={<Users />}>\n        <Route path=":id" element={<UserDetail />} />\n        <Route path="create" element={<NewUser />} />\n      </Route>\n    </Routes>\n  );\n}\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("当访问 /user/123 的时候，组件树将会变成这样")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("<App>\n    <Users>\n        <UserDetail/>\n    </Users>\n</App>\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("如果只是内部组件修改，也可以采用"),a("code",[s._v("<Outlet/>")]),s._v("来直接实现，如下所示")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function App() {\n  return (\n    <Routes>\n      <Route path="user" element={<Users />}>\n        <Route path=":id" element={<UserDetail />} />\n        <Route path="create" element={<NewUser />} />\n      </Route>\n    </Routes>\n  );\n}\nfunction Users() {\n  return (\n    <div>\n      <h1>Users</h1>\n      <Outlet />\n    </div>\n  );\n}\n\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h3",{attrs:{id:"index路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#index路由"}},[s._v("#")]),s._v(" index路由")]),s._v(" "),a("p",[s._v("index属性解决当嵌套路由有多个子路由但本身无法确认默认渲染哪个子路由的时候，可以增加index属性来指定默认路由")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function App() {\n  return (\n    <Routes>\n      <Route path="/" element={<Layout />}>\n        <Route index element={<About />} />\n        <Route path="user" element={<User />} />\n        <Route path="about" element={<About />} />\n      </Route>\n    </Routes>\n  );\n}\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("p",[s._v("这样当访问/的时候"),a("code",[s._v("<Outlet/>")]),s._v("会默认渲染About组件")]),s._v(" "),a("h3",{attrs:{id:"路由通配符"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#路由通配符"}},[s._v("#")]),s._v(" 路由通配符")]),s._v(" "),a("p",[s._v("整个react-router支持以下几种通配符")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("/groups\n/groups/admin\n/users/:id\n/users/:id/messages\n/files/*\n/files/:id/*\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("这里的"),a("code",[s._v("*")]),s._v("只能用在/后面，不能用在实际路径中间")]),s._v(" "),a("p",[s._v("关于NotFound类路由，可以用"),a("code",[s._v("*")]),s._v("来代替")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function App() {\n  return (\n    <Routes>\n      <Route path="/" element={<Home />} />\n      <Route path="dashboard" element={<Dashboard />} />\n      <Route path="*" element={<NotFound />} />\n    </Routes>\n  );\n}\n\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h3",{attrs:{id:"获取参数-useparams-和usesearchparams"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取参数-useparams-和usesearchparams"}},[s._v("#")]),s._v(" 获取参数 useParams 和useSearchParams")]),s._v(" "),a("p",[s._v("假设现有App路由")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function App() {\n return (\n   <Routes>\n     <Route path="user" element={<Users />}>\n       <Route path=":id" element={<UserDetail />} />\n       <Route path="create" element={<NewUser />} />\n     </Route>\n   </Routes>\n );\n}\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("那么在UserDetail内部需要用useParams来获取对应的参数")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('import { useParams } from "react-router-dom";\n\nexport default function UserDetail() {\n  let params = useParams();\n  return <h2>User: {params.id}</h2>;\n}\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("useSearchParams相对复杂，他返回的是一个当前值和set方法")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v(" let [searchParams, setSearchParams] = useSearchParams();\n复制代码\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("使用时可以用"),a("code",[s._v('searchParams.get("id")')]),s._v('来获取参数，同时页面内也可以setSearchParams({"id":2})来改变路由，这样当访问 '),a("a",{attrs:{href:"https://link.juejin.cn?target=http%3A%2F%2FURL%2Fuser%3Fid%3D111",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://URL/user?id=111"),a("OutboundLink")],1),s._v(" 时就可以获取和设置路径")]),s._v(" "),a("h3",{attrs:{id:"usenavigate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#usenavigate"}},[s._v("#")]),s._v(" useNavigate")]),s._v(" "),a("p",[s._v("useNavigate是替代原有V5中的useHistory的新hooks，其用法和useHistory类似，整体使用起来更轻量，他的声明方式如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('declare function useNavigate(): NavigateFunction;\n\ninterface NavigateFunction {\n  (\n    to: To,\n    options?: { replace?: boolean; state?: State }\n  ): void;\n  (delta: number): void;\n}\n复制代码\n  //js写法\n  let navigate = useNavigate();\n  function handleClick() {\n    navigate("/home");\n  }\n  //组件写法\n  function App() {\n     return <Navigate to="/home" replace state={state} />;\n  }\n  //替代原有的go goBack和goForward\n <button onClick={() => navigate(-2)}>\n    Go 2 pages back\n  </button>\n  <button onClick={() => navigate(-1)}>Go back</button>\n  <button onClick={() => navigate(1)}>\n    Go forward\n  </button>\n  <button onClick={() => navigate(2)}>\n    Go 2 pages forward\n  </button>\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br")])]),a("p",[s._v("嗨，中途床图 gitee还坏了，不得不换阿里的 oss 了。")]),s._v(" "),a("h2",{attrs:{id:"闪屏问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#闪屏问题"}},[s._v("#")]),s._v(" 闪屏问题")]),s._v(" "),a("p",[s._v("中途采用了 lazy 加载页面，所以就会造成闪屏，在代码中也有体现，最后决定采用局部加载的方式，来渲染二级路由，具体可以参见代码仓库，简单来说就是 "),a("code",[s._v("LayoutPage")]),s._v("（公共布局组件不使用懒加载的方式）。")]),s._v(" "),a("h2",{attrs:{id:"权限思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#权限思路"}},[s._v("#")]),s._v(" 权限思路")]),s._v(" "),a("h3",{attrs:{id:"动态菜单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态菜单"}},[s._v("#")]),s._v(" 动态菜单")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('function genMenu(menuConfig) {\n  return menuConfig.map(menuItem => {\n    if (menuItem.children) {\n      return <SubMenu\n        key={menuItem.id}\n        icon={<NotificationOutlined/>}\n        title={menuItem.name}\n      >\n        {genMenu(menuItem.children)}\n      </SubMenu>\n    } else {\n      return <Menu.Item key={menuItem.id} path={menuItem.path}>{menuItem.name}</Menu.Item>\n    }\n  })\n}\n            <Menu\n              mode="inline"\n              defaultSelectedKeys={["1"]}\n              defaultOpenKeys={["sub1"]}\n              onSelect={handleSelect}\n              style={{height: "100%", borderRight: 0}}\n            >\n              {genMenu(menu[0].children)}\n            </Menu>\n复制代码\n')])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br")])]),a("h3",{attrs:{id:"动态路由"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动态路由"}},[s._v("#")]),s._v(" 动态路由")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("// 经过分析发现  菜单是有父子关系的 ， 而路由没有子路由都属于 LayoutPage 的子路由\n\n// path 命名采用 驼峰命名法 helloWorld\n// 组件的目录命名采用 HelloWorld 命名方式\n// 所以就需要编写一个函数  将 path /helloWorld 转换成 /HelloWorld ，也就是/后面的第一个字符准换成大写的\n\nfunction convertPath (path) {\n  let arr = path.split('/')\n  //  forEach 调用的时候 item 如果普通类型如果给 item 重新赋值 则不会修改原始值\n  //  如果是引用类型  直接改变指针的指向则原始值不会被修改\n  //  如果是引用类型  在原来引用的基础上修改会修改原始值\n  return arr.map(item => {\n    if (item) {\n      return item[0].toUpperCase() + item.substring(1)\n    }else {\n      return item\n    }\n  }).join('/')\n}\n\nlet router = [\n  {\n    path: \"/login\",\n    element: LazyWrapper('Login'),\n  },\n  {\n    path: \"/\",\n    element: <LayoutPage/>,\n    children: [],\n  },\n];\n\n// 包装 React.lazy函数\nfunction LazyWrapper(path) {\n  const Component = lazy(() => import(`../pages${path}`))\n  return (\n    <Suspense fallback={<div>loading</div>}>\n      <Component/>\n    </Suspense>\n  );\n}\n\n// 收集所有的叶子节点，生成路由信息\nfunction genRouter(menuConfig, router) {\n  menuConfig.forEach(menuItem => {\n    if(!menuItem.children) {\n      router.push({\n        path: menuItem.path,\n        element: LazyWrapper(convertPath(menuItem.path))\n      })\n    }else {\n      genRouter(menuItem.children, router)\n    }\n  })\n}\ngenRouter(menu[0].children, router[1].children)\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br")])])])}),[],!1,null,null,null);n.default=t.exports}}]);